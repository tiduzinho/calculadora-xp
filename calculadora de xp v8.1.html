<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de XP</title>
    <style>
        body { font-family: sans-serif; background-color: #2c2c2c; color: #f0f0f0; max-width: 700px; margin: 20px auto; padding: 20px; border-radius: 8px; }
        h1, h2 { text-align: center; color: #ffc107; }
        h3 { color: #f0f0f0; border-bottom: 1px solid #444; padding-bottom: 5px; margin-top: 0; }
        
        .section-box { background-color: #3c3c3c; padding: 15px; border-radius: 4px; margin-bottom: 20px; border: 1px solid #444; }
        
        .input-group, .quest-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; cursor: pointer; color: #ccc; font-size: 0.9em; }
        
        input[type="number"], input[type="text"], select { 
            width: 100%; padding: 10px; box-sizing: border-box; 
            background-color: #222; color: #f0f0f0; 
            border: 1px solid #555; border-radius: 4px; 
            font-size: 1em;
        }
        
        /* Layout em colunas para o Planejador */
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .grid-3-auto { display: grid; grid-template-columns: 2fr 1fr; gap: 10px; align-items: end; }

        .bonus-group { background-color: #222; padding: 10px 15px; border-radius: 4px; display: flex; align-items: center; margin-bottom: 20px; border: 1px solid #555; }
        .bonus-group label { margin: 0; margin-left: 10px; font-size: 1em; color: #f0f0f0; }
        
        /* Estilo das Quests */
        .quest-list { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .quest-item input[type="checkbox"] { display: none; }
        .quest-item label { display: flex; align-items: center; background-color: #222; padding: 10px; border-radius: 4px; transition: all 0.2s; border: 1px solid #444; cursor: pointer; }
        .quest-item label:hover { background-color: #333; border-color: #666; }
        .quest-level-badge { background-color: #555; color: #ffc107; padding: 2px 6px; border-radius: 4px; font-weight: bold; margin-right: 10px; font-size: 12px; }
        .quest-name { font-size: 13px; color: #f0f0f0; }
        .quest-item input[type="checkbox"]:checked + label { border-color: #ffc107; background-color: #444; }
        .quest-item input[type="checkbox"]:checked + label .quest-level-badge { background-color: #ffc107; color: #2c2c2c; }
        
        button { width: 100%; margin-top: 10px; padding: 12px; font-size: 16px; background-color: #ffc107; color: #2c2c2c; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; transition: background-color 0.2s; }
        button:hover { background-color: #ffca2c; }
        
        /* Resultados */
        #results, #plannerResults, #resultsConverter { margin-top: 20px; background-color: #222; padding: 15px; border-radius: 4px; text-align: center; border: 1px solid #444; }
        .result-line { margin: 10px 0; font-size: 1.1em; }
        .highlight { color: #4caf50; font-weight: bold; font-size: 1.2em; }
        .sub-text { font-size: 0.85em; color: #888; display: block; margin-top: 2px; }
        
        .credits { text-align: center; margin-top: 30px; font-size: 0.9em; color: #666; }
        hr { border: 0; border-top: 1px solid #444; margin: 30px 0; }
    </style>
</head>
<body>

    <h1>Calculadora de XP</h1>

    <div class="section-box">
        <h3>üìä Planejamento de UP</h3>
        
        <div class="grid-2">
            <div class="input-group">
                <label for="currentLevel">N√≠vel Atual:</label>
                <input type="number" id="currentLevel" placeholder="Ex: 100">
            </div>
            <div class="input-group">
                <label for="currentPercent">% Atual:</label>
                <input type="number" id="currentPercent" placeholder="Ex: 45.5" step="0.01">
            </div>
        </div>

        <div class="input-group">
            <label for="targetLevel">N√≠vel Alvo (Meta):</label>
            <input type="number" id="targetLevel" placeholder="Ex: 105">
        </div>

        <div class="grid-3-auto">
            <div class="input-group">
                <label for="xpHourInput">XP por Hora:</label>
                <input type="number" id="xpHourInput" placeholder="Ex: 1.5" step="0.1">
            </div>
            <div class="input-group">
                <label for="xpUnitSelect">Unidade:</label>
                <select id="xpUnitSelect">
                    <option value="1000000000">B (Bilh√£o)</option>
                    <option value="1000000000000" selected>T (Trilh√£o)</option>
                </select>
            </div>
        </div>

        <button onclick="calculateGrind()">Calcular Tempo e Meta</button>

        <div id="plannerResults" style="display: none;">
            </div>
    </div>

    <hr>

    <div class="section-box">
        <h3>‚öîÔ∏è Calculadora de Quests</h3>
        
        <div class="input-group">
            <label>N√≠vel para c√°lculo das Quests:</label>
            <input type="number" id="questLevelDisplay" placeholder="N√≠vel das Quests">
        </div>

        <div class="bonus-group">
            <input type="checkbox" id="premiumBonus">
            <label for="premiumBonus">Servi√ßo Premium (+20%)</label>
        </div>

        <div class="quest-group">
            <label>Selecione as Quests:</label>
            <div class="quest-list" id="questList"></div>
        </div>

        <button onclick="calculateQuestXP()">Calcular Ganho das Quests</button>

        <div id="results" style="display: none;">
            <p class="result-line" id="gainText1x"></p>
            <span id="rawXPGain1x" class="sub-text"></span>
            
            <p class="result-line" id="gainText2x"></p>
            <span id="rawXPGain2x" class="sub-text"></span>
        </div>
    </div>

    <div class="section-box">
        <h3>üîÑ Conversor R√°pido (XP -> %)</h3>
        <div class="input-group">
            <label for="rawXpInput">XP Bruto:</label>
            <input type="text" id="rawXpInput" placeholder="Ex: 500.000.000" inputmode="numeric">
        </div>
        <button onclick="convertXP()">Converter</button>
        <div id="resultsConverter" style="display: none;">
            <p class="result-line" id="converterGainText"></p>
        </div>
    </div>

    <div class="credits">
        Cr√©ditos: TiduzinhO
    </div>

<script>
    // --- BANCO DE DADOS ATUALIZADO (At√© 190) ---
    const xpTable = { 80: 225148692, 81: 252000000, 82: 283000000, 83: 317000000, 84: 355000000, 85: 397000000, 86: 445000000, 87: 498000000, 88: 559000000, 89: 1042000000, 90: 1250000000, 91: 1501000000, 92: 1800000000, 93: 2161000000, 94: 2593000000, 95: 3112000000, 96: 3733000000, 97: 4481000000, 98: 5377000000, 99: 6452000000, 100: 7742000000, 101: 9291000000, 102: 11149000000, 103: 13379000000, 104: 16055000000, 105: 19266000000, 106: 23118000000, 107: 27743000000, 108: 33291000000, 109: 39949000000, 110: 47940000000, 111: 57527000000, 112: 69032000000, 113: 82839000000, 114: 99407000000, 115: 119288000000, 116: 143146000000, 117: 171775000000, 118: 206130000000, 119: 247355000000, 120: 222620000000, 121: 256013000000, 122: 294415000000, 123: 338578000000, 124: 389364000000, 125: 437769000000, 126: 524934000000, 127: 592174000000, 128: 681000000000, 129: 678730000000, 130: 766965000000, 131: 866671000000, 132: 979337000000, 133: 1106652000000, 134: 1250516000000, 135: 1413084000000, 136: 1596785000000, 137: 1804367000000, 138: 2038935000000, 139: 1949532000000, 140: 2163983000000, 141: 2402022000000, 142: 2666244000000, 143: 2959530000000, 144: 3285079000000, 145: 3646438000000, 146: 4047546000000, 147: 4492776000000, 148: 4986981000000, 149: 5535549000000, 150: 7261634000000, 151: 8205647000000, 152: 9272380000000, 153: 10477790000000, 154: 11839903000000, 155: 13379090000000, 156: 15118372000000, 157: 17083760000000, 158: 19304649000000, 159: 21814253000000, 160: 26546269000000, 161: 32424370000000, 162: 39773895000000, 163: 49021325000000, 164: 60728771000000, 165: 75641057000000, 166: 94750378000000, 167: 119385476000000, 168: 151335304000000, 169: 184629070000000, 170: 266201550000000, 171: 387016100000000, 172: 553432234000000, 173: 780676000000000, 174: 1114136000000000, 175: 1608873000000000, 176: 2351017000000000, 177: 3395786000000000, 178: 4936826000000000, 179: 7223839000000000, 180: 10706202000000000, 181: 15768968847000000, 182: 24021200153000000, 183: 35550888813000000, 184: 54810952530000000, 185: 82216428795000000, 186: 125798348606000000, 187: 188697522909000000, 188: 300055207748000000, 189: 467746348486000000, 190: 713943348287000000 };
    
    const questData = [ { level: 80, name: "M√°quinas de Combate", xp: 513480000 }, { level: 85, name: "Engrenagens do Destino", xp: 757680000 }, { level: 90, name: "Entrando Numa Fria", xp: 1082730000 }, { level: 95, name: "Combate na Ilha", xp: 3730320000 }, { level: 100, name: "Aberra√ß√µes Mortais", xp: 7818582000 }, { level: 105, name: "Guerreiros do Passado", xp: 18117000000 }, { level: 108, name: "Guardi√µes Igolanos", xp: 20164608000 }, { level: 110, name: "Combate Congelante", xp: 33766200000 }, { level: 118, name: "M√°quinas das Trevas", xp: 41496000000 }, { level: 123, name: "Protetores da Arma", xp: 69949440000 }, { level: 130, name: "O Mundo Sombrio", xp: 84779847000 }, { level: 140, name: "Descobrindo as Profundezas", xp: 149527186050 }, { level: 150, name: "Confronto sob as √Åguas", xp: 165966682200 }, { level: 155, name: "Ru√≠nas da Cidade Antiga", xp: 173553511312 }, { level: 160, name: "Covil do Drag√£o de Gelo", xp: 184546793062 }, { level: 165, name: "O Recome√ßo da Guerra", xp: 219560137500 }, { level: 170, name: "Salve o Reino do Mar", xp: 265962910714 } ];

    const formatXP = (num) => num.toLocaleString('pt-BR', { maximumFractionDigits: 0 });
    
    // Formata o input de XP Bruto com pontos
    function formatRawXPInput(e) {
        let value = e.target.value;
        let num = value.replace(/\D/g, ''); 
        if (num.length === 0) { e.target.value = ''; return; }
        e.target.value = Number(num).toLocaleString('pt-BR');
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Popula quests
        const questListDiv = document.getElementById('questList');
        questData.forEach(quest => {
            const questId = `quest-${quest.level}`;
            const questItem = document.createElement('div');
            questItem.className = 'quest-item';
            questItem.innerHTML = `<input type="checkbox" id="${questId}" data-xp="${quest.xp}"><label for="${questId}"><span class="quest-level-badge">${quest.level}</span><span class="quest-name">${quest.name}</span></label>`;
            questListDiv.appendChild(questItem);
        });

        // Sincroniza o n√≠vel das quests com o n√≠vel do planejador
        const currentLevelInput = document.getElementById('currentLevel');
        const questLevelDisplay = document.getElementById('questLevelDisplay');
        currentLevelInput.addEventListener('input', function() {
            // S√≥ sincroniza se o campo de quests estiver vazio ou igual ao antigo
            // Mas para manter simples e como voc√™ pediu: ele vem pre-selecionado, o user edita se quiser.
            // Vou for√ßar a atualiza√ß√£o sempre que o de cima mudar, pois √© o comportamento "pre-selecionado".
            questLevelDisplay.value = this.value;
        });

        // Formata√ß√£o do input conversor
        const rawXpInput = document.getElementById('rawXpInput');
        rawXpInput.addEventListener('input', formatRawXPInput);
    });

    // === 1. L√ìGICA DO PLANEJADOR DE GRIND ===
    function calculateGrind() {
        const currentLevel = parseInt(document.getElementById('currentLevel').value);
        const currentPercent = parseFloat(document.getElementById('currentPercent').value) || 0;
        const targetLevel = parseInt(document.getElementById('targetLevel').value);
        
        if (!currentLevel || !targetLevel) { alert("Preencha o N√≠vel Atual e o N√≠vel Alvo."); return; }
        if (!xpTable[currentLevel]) { alert("N√≠vel Atual fora da tabela (80-190)."); return; }
        if (targetLevel <= currentLevel) { alert("O N√≠vel Alvo deve ser maior que o N√≠vel Atual."); return; }

        let totalXpNeeded = 0;
        
        const xpForCurrent = xpTable[currentLevel];
        const percentRemaining = 100 - currentPercent;
        const xpRemainingInCurrent = xpForCurrent * (percentRemaining / 100);
        totalXpNeeded += xpRemainingInCurrent;
        
        for (let i = currentLevel + 1; i < targetLevel; i++) {
            if (xpTable[i]) {
                totalXpNeeded += xpTable[i];
            }
        }
        
        let timeResultHTML = "";
        const xpHourValue = parseFloat(document.getElementById('xpHourInput').value);
        const xpUnitMult = parseFloat(document.getElementById('xpUnitSelect').value);
        
        if (xpHourValue > 0) {
            const xpHourTotal = xpHourValue * xpUnitMult;
            const percentPerHour = (xpHourTotal / xpTable[currentLevel]) * 100;
            const totalHours = totalXpNeeded / xpHourTotal;
            const hours = Math.floor(totalHours);
            const minutes = Math.floor((totalHours - hours) * 60);
            
            timeResultHTML = `
                <hr style="margin: 15px 0; opacity: 0.3;">
                <p class="result-line">Ritmo: <span class="highlight">${percentPerHour.toFixed(3)}%</span> / hora</p>
                <p class="result-line">Tempo Estimado: <span class="highlight">${hours}h ${minutes}m</span></p>
                <span class="sub-text">(Considerando XP/h constante)</span>
            `;
        }

        const resultsDiv = document.getElementById('plannerResults');
        resultsDiv.innerHTML = `
            <p class="result-line">Falta para o n√≠vel ${targetLevel}:</p>
            <span class="highlight">${formatXP(totalXpNeeded)} XP</span>
            ${timeResultHTML}
        `;
        resultsDiv.style.display = 'block';
    }

    // === 2. L√ìGICA DE QUESTS (MODIFICADA) ===
    function calculateQuestXP() {
        // [AJUSTE] Agora l√™ o valor do input da pr√≥pria se√ß√£o, n√£o l√° de cima
        const level = parseInt(document.getElementById('questLevelDisplay').value);
        if (!level || !xpTable[level]) { alert('Preencha um N√≠vel v√°lido na se√ß√£o de Quests.'); return; }

        const premiumCheckbox = document.getElementById('premiumBonus');
        const bonusMultiplier = premiumCheckbox.checked ? 1.20 : 1.0;
        
        let totalXPGained = 0;
        document.querySelectorAll('#questList input[type="checkbox"]:checked').forEach(cb => {
            totalXPGained += parseFloat(cb.getAttribute('data-xp'));
        });

        if (totalXPGained === 0) { alert('Selecione ao menos uma quest.'); return; }

        const xpNeeded = xpTable[level];
        const xp1x = totalXPGained * bonusMultiplier;
        const xp2x = totalXPGained * 2 * bonusMultiplier;

        // [AJUSTE] .toFixed(3) para mais precis√£o
        document.getElementById('gainText1x').innerHTML = `Ganho (1x): <span class="highlight">${((xp1x/xpNeeded)*100).toFixed(3)}%</span>`;
        document.getElementById('rawXPGain1x').innerText = `XP Bruto: ${formatXP(xp1x)}`;
        
        document.getElementById('gainText2x').innerHTML = `Ganho (2x): <span class="highlight">${((xp2x/xpNeeded)*100).toFixed(3)}%</span>`;
        document.getElementById('rawXPGain2x').innerText = `XP Bruto: ${formatXP(xp2x)}`;

        document.getElementById('results').style.display = 'block';
    }

    // === 3. L√ìGICA DO CONVERSOR ===
    function convertXP() {
        const level = parseInt(document.getElementById('currentLevel').value);
        if (!level || !xpTable[level]) { alert('Preencha o N√≠vel Atual l√° em cima.'); return; }
        
        const rawXPString = document.getElementById('rawXpInput').value.replace(/\./g, '');
        const rawXP = parseFloat(rawXPString);
        
        if (!rawXP) { alert('Insira um valor de XP v√°lido.'); return; }
        
        const percent = (rawXP / xpTable[level]) * 100;
        document.getElementById('converterGainText').innerHTML = `Resultado: <span class="highlight">${percent.toFixed(3)}%</span>`;
        document.getElementById('resultsConverter').style.display = 'block';
    }
</script>

</body>
</html>